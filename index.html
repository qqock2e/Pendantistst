<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë½‘ê¸° ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        .glow-button {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }
        .glow-button:hover, .glow-button:active {
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.8);
            transform: translateY(-2px);
        }
        .currency-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .gacha-button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }
        .gacha-button:hover, .gacha-button:active {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(245, 87, 108, 0.4);
        }
        .point-button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        /* ë“±ê¸‰ë³„ ë°°ê²½ìƒ‰ */
        .grade-common {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #495057;
        }
        .grade-rare {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            color: white;
        }
        .grade-epic {
            background: linear-gradient(135deg, #9775fa 0%, #845ef7 100%);
            color: white;
        }
        .grade-legendary {
            background: linear-gradient(135deg, #ffd43b 0%, #fab005 100%);
            color: #495057;
        }
        .grade-unique {
            background: linear-gradient(45deg, #ff6b6b 0%, #feca57 16.66%, #48dbfb 33.33%, #0abde3 50%, #ff9ff3 66.66%, #54a0ff 83.33%, #5f27cd 100%);
            background-size: 400% 400%;
            animation: rainbow 3s ease infinite;
            color: white;
        }
        
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 640px) {
            .currency-card {
                padding: 1rem;
                min-width: 120px;
            }
            .currency-card .text-3xl {
                font-size: 1.5rem;
            }
            .point-button {
                padding: 1rem 2rem;
                font-size: 1rem;
            }
            .gacha-button {
                padding: 1.25rem 2.5rem;
                font-size: 1.125rem;
            }
        }
        
        @media (max-width: 480px) {
            .currency-card {
                padding: 0.75rem;
                min-width: 100px;
            }
            .currency-card .text-3xl {
                font-size: 1.25rem;
            }
            .point-button {
                padding: 0.875rem 1.5rem;
                font-size: 0.875rem;
            }
            .gacha-button {
                padding: 1rem 2rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex flex-col items-center justify-center p-4">
    
    <!-- ë©”ì¸ UI ì˜ì—­ -->
    <div id="mainUI" class="transition-opacity duration-500">
        <!-- ì¬í™” í‘œì‹œ ì˜ì—­ -->
        <div class="flex gap-4 sm:gap-6 mb-8 sm:mb-12">
            <!-- í¬ì¸íŠ¸ -->
            <div class="currency-card rounded-2xl p-6 text-center text-white shadow-2xl">
                <div class="text-xs sm:text-sm font-medium opacity-80 mb-2">í¬ì¸íŠ¸</div>
                <div id="points" class="text-3xl font-bold">0</div>
            </div>
            
            <!-- í”„ë¦¬ì¦˜ -->
            <div class="currency-card rounded-2xl p-6 text-center text-white shadow-2xl">
                <div class="text-xs sm:text-sm font-medium opacity-80 mb-2">í”„ë¦¬ì¦˜</div>
                <div id="prisms" class="text-3xl font-bold">0</div>
            </div>
        </div>

        <!-- ê²Œì„ ë²„íŠ¼ ì˜ì—­ -->
        <div class="flex flex-col items-center gap-4 sm:gap-6">
            <!-- ìƒë‹¨ ë²„íŠ¼ë“¤ -->
            <div class="flex gap-4 items-center">
                <!-- í¬ì¸íŠ¸ íšë“ ë²„íŠ¼ -->
                <button id="earnPointsBtn" class="point-button glow-button px-8 py-3 rounded-full text-white font-bold text-lg shadow-2xl touch-manipulation">
                    âœ¨ í¬ì¸íŠ¸ íšë“ âœ¨
                </button>
                
                <!-- ì¸ë²¤í† ë¦¬ ë²„íŠ¼ -->
                <button id="inventoryBtn" class="bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 px-8 py-3 rounded-full text-white font-bold text-lg shadow-2xl touch-manipulation transition-all duration-300">
                    ğŸ’ ì¸ë²¤í† ë¦¬
                </button>
                
                <!-- ì„¤ì • ë²„íŠ¼ -->
                <button id="settingsBtn" class="bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 px-8 py-3 rounded-full text-white font-bold text-lg shadow-2xl touch-manipulation transition-all duration-300">
                    âš™ï¸ ì„¤ì •
                </button>
            </div>
            
            <!-- ìƒì  ë²„íŠ¼ -->
            <button id="shopBtn" class="gacha-button px-16 py-5 rounded-full text-white font-bold text-2xl shadow-2xl touch-manipulation">
                ğŸª ìƒì  ğŸª
            </button>
            
            <!-- ì¥ì°©ëœ ë³´ì„ í‘œì‹œ -->
            <div id="equippedGemDisplay" class="mt-4 bg-white bg-opacity-10 rounded-xl p-4 text-center text-white opacity-0 transition-all duration-300">
                <div class="text-sm opacity-80 mb-2">ì¥ì°©ëœ ë³´ì„</div>
                <div id="equippedGemIcon" class="text-3xl mb-2">ğŸ’</div>
                <div id="equippedGemName" class="font-bold mb-1">ë³´ì„ ì´ë¦„</div>
                <div id="equippedGemStats" class="text-sm opacity-80">ì½”ëŸ¬ìŠ¤ +1</div>
            </div>
        </div>

        <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
        <div id="message" class="mt-6 sm:mt-8 text-center text-white font-medium text-base sm:text-lg opacity-0 transition-opacity duration-300 px-4"></div>
    </div>

    <!-- ë½‘ê¸° ëª¨ì…˜ í™”ë©´ -->
    <div id="gachaScreen" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-500">
        <div class="text-center">
            <!-- ì›ì„ ì´ë¯¸ì§€ (ë‚˜ì¤‘ì— ì‹¤ì œ ì´ë¯¸ì§€ë¡œ êµì²´ ê°€ëŠ¥) -->
            <div id="gemstone" class="w-32 h-32 sm:w-40 sm:h-40 bg-gray-300 rounded-lg mx-auto mb-6 cursor-pointer transform transition-all duration-300 hover:scale-110 shadow-2xl flex items-center justify-center text-4xl">
                ğŸ’
            </div>
            <p class="text-white text-lg sm:text-xl font-medium">ì›ì„ì„ í´ë¦­í•˜ì„¸ìš”!</p>
        </div>
    </div>

    <!-- ë“±ê¸‰ ê³µê°œ í™”ë©´ -->
    <div id="revealScreen" class="fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-1000">
        <div class="text-center">
            <div id="gradeText" class="text-6xl sm:text-8xl font-bold mb-4 drop-shadow-2xl"></div>
            <p class="text-white text-xl sm:text-2xl font-medium mb-8">ë“±ê¸‰ì´ ê³µê°œë˜ì—ˆìŠµë‹ˆë‹¤!</p>
            <button id="continueBtn" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-8 py-3 rounded-full text-white font-bold text-lg transition-all duration-300">
                ê³„ì†í•˜ê¸°
            </button>
        </div>
    </div>

    <!-- ë³´ì„ íšë“ í™”ë©´ -->
    <div id="gemRewardScreen" class="fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-1000 bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900">
        <div class="text-center">
            <!-- ë³´ì„ ì´ë¯¸ì§€ (ë‚˜ì¤‘ì— ì‹¤ì œ ì´ë¯¸ì§€ë¡œ êµì²´ ê°€ëŠ¥) -->
            <div id="rewardGemImage" class="w-24 h-24 sm:w-32 sm:h-32 bg-yellow-400 rounded-full mx-auto mb-6 shadow-2xl flex items-center justify-center text-3xl sm:text-4xl">
                ğŸ’
            </div>
            <div id="rewardText" class="text-4xl sm:text-6xl font-bold text-white mb-8 drop-shadow-2xl">1ë³´ì„ íšë“!</div>
            <button id="finalContinueBtn" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-8 py-3 rounded-full text-white font-bold text-lg transition-all duration-300">
                í™•ì¸
            </button>
        </div>
    </div>

    <!-- ìƒì  í™”ë©´ -->
    <div id="shopScreen" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-500">
        <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl w-11/12 max-w-2xl p-6">
            <!-- ìƒì  í—¤ë” -->
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-white">ğŸª ìƒì </h2>
                <button id="closeShopBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">
                    âœ• ë‹«ê¸°
                </button>
            </div>
            
            <!-- ë½‘ê¸° ëª©ë¡ -->
            <div class="space-y-4">
                <!-- ì´ˆì‹¬ìì˜ ì›ì„ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-bold text-white mb-1">ğŸª¨ ì´ˆì‹¬ìì˜ ì›ì„</h3>
                        <p class="text-gray-300 text-sm">ê¸°ë³¸ì ì¸ ë³´ì„ì´ ë‚˜ì˜¤ëŠ” ì›ì„ì…ë‹ˆë‹¤</p>
                        <p class="text-blue-300 font-medium">ğŸ’° 10 í¬ì¸íŠ¸</p>
                    </div>
                    <button onclick="startGacha('beginner')" class="bg-blue-500 hover:bg-blue-600 px-6 py-3 rounded-full text-white font-bold transition-all duration-300">
                        ë½‘ê¸°
                    </button>
                </div>
                
                <!-- ë¹›ë‚˜ëŠ” ì›ì„ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-bold text-white mb-1">âœ¨ ë¹›ë‚˜ëŠ” ì›ì„</h3>
                        <p class="text-gray-300 text-sm">ê· í˜•ì¡íŒ í™•ë¥ ì˜ ì›ì„ì…ë‹ˆë‹¤</p>
                        <p class="text-purple-300 font-medium">ğŸ’ 5 í”„ë¦¬ì¦˜</p>
                    </div>
                    <button onclick="startGacha('normal')" class="bg-purple-500 hover:bg-purple-600 px-6 py-3 rounded-full text-white font-bold transition-all duration-300">
                        ë½‘ê¸°
                    </button>
                </div>
                
                <!-- ì˜ë¡±í•œ ì›ì„ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-bold text-white mb-1">ğŸŒŸ ì˜ë¡±í•œ ì›ì„</h3>
                        <p class="text-gray-300 text-sm">ê³ ê¸‰ ë³´ì„ì´ ë” ì˜ ë‚˜ì˜¤ëŠ” ì›ì„ì…ë‹ˆë‹¤</p>
                        <p class="text-purple-300 font-medium">ğŸ’ 30 í”„ë¦¬ì¦˜</p>
                    </div>
                    <button onclick="startGacha('premium')" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 px-6 py-3 rounded-full text-white font-bold transition-all duration-300">
                        ë½‘ê¸°
                    </button>
                </div>
                
                <!-- ê´‘ì•ˆì˜ ì›ì„ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-bold text-white mb-1">ğŸ’« ê´‘ì•ˆì˜ ì›ì„</h3>
                        <p class="text-gray-300 text-sm">ìµœê³ ê¸‰ ë³´ì„ì´ íŠ¹ë³„í•œ í™•ë¥ ë¡œ ë‚˜ì˜¤ëŠ” ì›ì„ì…ë‹ˆë‹¤</p>
                        <p class="text-purple-300 font-medium">ğŸ’ 40 í”„ë¦¬ì¦˜</p>
                    </div>
                    <button onclick="startGacha('luxury')" class="bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 px-6 py-3 rounded-full text-white font-bold transition-all duration-300">
                        ë½‘ê¸°
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì„¤ì • í™”ë©´ -->
    <div id="settingsScreen" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-500">
        <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl w-11/12 max-w-md p-6">
            <!-- ì„¤ì • í—¤ë” -->
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-white">âš™ï¸ ì„¤ì •</h2>
                <button id="closeSettingsBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">
                    âœ• ë‹«ê¸°
                </button>
            </div>
            
            <!-- ì„¤ì • ì˜µì…˜ë“¤ -->
            <div class="space-y-4">
                <!-- ìˆ˜ë™ ì €ì¥ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4">
                    <h3 class="text-lg font-bold text-white mb-2">ğŸ’¾ ê²Œì„ ì €ì¥</h3>
                    <p class="text-gray-300 text-sm mb-3">ê²Œì„ì´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì§€ë§Œ, ìˆ˜ë™ìœ¼ë¡œë„ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <button onclick="saveGameData(); showMessage('ê²Œì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'text-green-300')" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">
                        ì €ì¥í•˜ê¸°
                    </button>
                </div>
                
                <!-- ë°ì´í„° ì´ˆê¸°í™” -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4">
                    <h3 class="text-lg font-bold text-white mb-2">ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”</h3>
                    <p class="text-gray-300 text-sm mb-3">ëª¨ë“  ê²Œì„ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ì²˜ìŒë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤.</p>
                    <button onclick="resetGameData()" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">
                        ì´ˆê¸°í™”
                    </button>
                </div>
                
                <!-- ì €ì¥ ì •ë³´ -->
                <div class="bg-white bg-opacity-5 rounded-xl p-4">
                    <h3 class="text-lg font-bold text-white mb-2">ğŸ“Š ì €ì¥ ì •ë³´</h3>
                    <div id="saveInfo" class="text-gray-300 text-sm">
                        <p>â€¢ ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì €ì— ìë™ ì €ì¥ë©ë‹ˆë‹¤</p>
                        <p>â€¢ ë¸Œë¼ìš°ì € ë°ì´í„°ë¥¼ ì‚­ì œí•˜ë©´ ê²Œì„ ë°ì´í„°ë„ ì‚¬ë¼ì§‘ë‹ˆë‹¤</p>
                        <p>â€¢ ê°™ì€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì¸ë²¤í† ë¦¬ í™”ë©´ -->
    <div id="inventoryScreen" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-500">
        <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl w-11/12 max-w-4xl h-5/6 max-h-96 sm:max-h-screen sm:h-4/5 p-6 flex flex-col">
            <!-- ì¸ë²¤í† ë¦¬ í—¤ë” -->
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl sm:text-3xl font-bold text-white">ğŸ’ ì¸ë²¤í† ë¦¬</h2>
                <button id="closeInventoryBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">
                    âœ• ë‹«ê¸°
                </button>
            </div>
            
            <!-- ì¸ë²¤í† ë¦¬ ë‚´ìš© -->
            <div class="flex flex-1 gap-6 overflow-hidden">
                <!-- ì¢Œì¸¡: ë³´ì„ ë¦¬ìŠ¤íŠ¸ -->
                <div class="w-1/2 bg-white bg-opacity-5 rounded-xl p-4 overflow-y-auto">
                    <h3 class="text-lg font-bold text-white mb-4">ë³´ì„ ëª©ë¡</h3>
                    <div id="gemList" class="grid grid-cols-3 sm:grid-cols-4 gap-3">
                        <!-- ë³´ì„ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <!-- ìš°ì¸¡: ë³´ì„ ìƒì„¸ ì •ë³´ -->
                <div class="w-1/2 bg-white bg-opacity-5 rounded-xl p-4">
                    <div id="gemDetails" class="text-center text-white">
                        <div class="text-6xl mb-4">ğŸ’</div>
                        <h3 class="text-xl font-bold mb-2">ë³´ì„ì„ ì„ íƒí•˜ì„¸ìš”</h3>
                        <p class="text-gray-300">ì¢Œì¸¡ì—ì„œ ë³´ì„ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let points = 0;
        let prisms = 0;
        let gems = 0; // ë³´ì„ ë³„ë„ ê´€ë¦¬
        let chorus = 1;
        let multiple = 1;
        let isGachaActive = false; // ë½‘ê¸° ì§„í–‰ ì¤‘ ìƒíƒœ ê´€ë¦¬
        let inventory = {}; // ì¸ë²¤í† ë¦¬ ê°ì²´ (ë³´ì„ID: ê°œìˆ˜)
        let equippedGem = null; // ì¥ì°©ëœ ë³´ì„ ID

        const pointsDisplay = document.getElementById('points');
        const prismsDisplay = document.getElementById('prisms');
        const earnPointsBtn = document.getElementById('earnPointsBtn');
        const shopBtn = document.getElementById('shopBtn');
        const inventoryBtn = document.getElementById('inventoryBtn');
        const messageDiv = document.getElementById('message');

        // ë³´ì„ ë°ì´í„° (ìœ ì§€ë³´ìˆ˜ ì‰½ê²Œ í•˜ê¸° ìœ„í•´ ë³„ë„ ê°ì²´ë¡œ ê´€ë¦¬)
        const gemData = {
            1: { name: 'ì‘ì€ ìˆ˜ì •', emoji: 'ğŸ’', chorus: 1, multiple: 1, description: 'ì‘ê³  íˆ¬ëª…í•œ ìˆ˜ì •ì…ë‹ˆë‹¤.' },
            2: { name: 'í‘¸ë¥¸ ìˆ˜ì •', emoji: 'ğŸ”·', chorus: 2, multiple: 1, description: 'í‘¸ë¥¸ë¹›ì´ ë„ëŠ” ì•„ë¦„ë‹¤ìš´ ìˆ˜ì •ì…ë‹ˆë‹¤.' },
            3: { name: 'ë¶‰ì€ ìˆ˜ì •', emoji: 'ğŸ”¶', chorus: 3, multiple: 1, description: 'ë¶‰ì€ë¹›ì´ ë„ëŠ” í™”ë ¤í•œ ìˆ˜ì •ì…ë‹ˆë‹¤.' },
            4: { name: 'ì—ë©”ë„ë“œ', emoji: 'ğŸ’š', chorus: 4, multiple: 1, description: 'ì‹ ë¹„ë¡œìš´ ë…¹ìƒ‰ ë³´ì„ì…ë‹ˆë‹¤.' },
            5: { name: 'ì‚¬íŒŒì´ì–´', emoji: 'ğŸ’™', chorus: 5, multiple: 1, description: 'ê¹Šì€ íŒŒë€ìƒ‰ì˜ ê³ ê¸‰ ë³´ì„ì…ë‹ˆë‹¤.' },
            6: { name: 'ë£¨ë¹„', emoji: 'â¤ï¸', chorus: 6, multiple: 1, description: 'ì •ì—´ì ì¸ ë¹¨ê°„ìƒ‰ ë³´ì„ì…ë‹ˆë‹¤.' },
            7: { name: 'ììˆ˜ì •', emoji: 'ğŸ’œ', chorus: 7, multiple: 1.1, description: 'ê³ ê·€í•œ ë³´ë¼ìƒ‰ ë³´ì„ì…ë‹ˆë‹¤.' },
            8: { name: 'í™©ê¸ˆì„', emoji: 'ğŸ’›', chorus: 8, multiple: 1.2, description: 'í™©ê¸ˆë¹›ìœ¼ë¡œ ë¹›ë‚˜ëŠ” ë³´ì„ì…ë‹ˆë‹¤.' },
            9: { name: 'ë‹¤ì´ì•„ëª¬ë“œ', emoji: 'ğŸ’', chorus: 9, multiple: 1.3, description: 'ê°€ì¥ ë‹¨ë‹¨í•˜ê³  ë¹›ë‚˜ëŠ” ë³´ì„ì…ë‹ˆë‹¤.' },
            10: { name: 'ì˜¤íŒ”', emoji: 'ğŸŒˆ', chorus: 10, multiple: 1.4, description: 'ë¬´ì§€ê°œë¹›ìœ¼ë¡œ ë³€í•˜ëŠ” ì‹ ë¹„í•œ ë³´ì„ì…ë‹ˆë‹¤.' },
            11: { name: 'ì§„ì£¼', emoji: 'ğŸ¤', chorus: 11, multiple: 1.5, description: 'ë°”ë‹¤ì—ì„œ ì˜¨ ìˆœë°±ì˜ ë³´ì„ì…ë‹ˆë‹¤.' },
            12: { name: 'í† íŒŒì¦ˆ', emoji: 'ğŸ§¡', chorus: 12, multiple: 1.6, description: 'ë”°ëœ»í•œ ì£¼í™©ë¹›ì˜ ë³´ì„ì…ë‹ˆë‹¤.' },
            13: { name: 'ë³„ì˜ ì¡°ê°', emoji: 'â­', chorus: 15, multiple: 2.0, description: 'í•˜ëŠ˜ì—ì„œ ë–¨ì–´ì§„ ë³„ì˜ ì¡°ê°ì…ë‹ˆë‹¤.' },
            14: { name: 'ë‹¬ì˜ ëˆˆë¬¼', emoji: 'ğŸŒ™', chorus: 20, multiple: 2.5, description: 'ë‹¬ë¹›ì´ ì‘ì¶•ëœ ì‹ ë¹„í•œ ë³´ì„ì…ë‹ˆë‹¤.' },
            15: { name: 'íƒœì–‘ì˜ ì‹¬ì¥', emoji: 'â˜€ï¸', chorus: 25, multiple: 3.0, description: 'íƒœì–‘ì˜ í˜ì´ ë‹´ê¸´ ì „ì„¤ì˜ ë³´ì„ì…ë‹ˆë‹¤.' }
        };

        // í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateDisplay() {
            pointsDisplay.textContent = points;
            prismsDisplay.textContent = prisms;
        }

        // ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showMessage(text, color = 'text-white') {
            messageDiv.textContent = text;
            messageDiv.className = `mt-8 text-center font-medium text-lg transition-opacity duration-300 ${color}`;
            messageDiv.style.opacity = '1';
            
            setTimeout(() => {
                messageDiv.style.opacity = '0';
            }, 2000);
        }

        // í¬ì¸íŠ¸ íšë“ ë²„íŠ¼ í´ë¦­
        earnPointsBtn.addEventListener('click', () => {
            if (isGachaActive) return; // ë½‘ê¸° ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            
            const earnedPoints = Math.round((1 + chorus) * multiple);
            points += earnedPoints;
            updateDisplay();
            autoSave(); // ìë™ ì €ì¥
            showMessage(`${earnedPoints} í¬ì¸íŠ¸ë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤!`, 'text-blue-300');
        });

        // ìƒì  ë²„íŠ¼ í´ë¦­
        shopBtn.addEventListener('click', () => {
            if (isGachaActive) return; // ë½‘ê¸° ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            openShop();
        });

        // ì¸ë²¤í† ë¦¬ ë²„íŠ¼ í´ë¦­
        inventoryBtn.addEventListener('click', () => {
            if (isGachaActive) return; // ë½‘ê¸° ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            openInventory();
        });

        // ì„¤ì • ë²„íŠ¼ í´ë¦­
        document.getElementById('settingsBtn').addEventListener('click', () => {
            if (isGachaActive) return; // ë½‘ê¸° ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            openSettings();
        });

        // ìƒì  ì—´ê¸°
        function openShop() {
            const shopScreen = document.getElementById('shopScreen');
            shopScreen.style.opacity = '1';
            shopScreen.style.pointerEvents = 'auto';
        }

        // ìƒì  ë‹«ê¸°
        document.getElementById('closeShopBtn').addEventListener('click', () => {
            const shopScreen = document.getElementById('shopScreen');
            shopScreen.style.opacity = '0';
            shopScreen.style.pointerEvents = 'none';
        });

        // ì¸ë²¤í† ë¦¬ ì—´ê¸°
        function openInventory() {
            const inventoryScreen = document.getElementById('inventoryScreen');
            inventoryScreen.style.opacity = '1';
            inventoryScreen.style.pointerEvents = 'auto';
            updateInventoryDisplay();
        }

        // ì¸ë²¤í† ë¦¬ ë‹«ê¸°
        document.getElementById('closeInventoryBtn').addEventListener('click', () => {
            const inventoryScreen = document.getElementById('inventoryScreen');
            inventoryScreen.style.opacity = '0';
            inventoryScreen.style.pointerEvents = 'none';
        });

        // ì„¤ì • ì—´ê¸°
        function openSettings() {
            const settingsScreen = document.getElementById('settingsScreen');
            settingsScreen.style.opacity = '1';
            settingsScreen.style.pointerEvents = 'auto';
        }

        // ì„¤ì • ë‹«ê¸°
        document.getElementById('closeSettingsBtn').addEventListener('click', () => {
            const settingsScreen = document.getElementById('settingsScreen');
            settingsScreen.style.opacity = '0';
            settingsScreen.style.pointerEvents = 'none';
        });

        // ì¸ë²¤í† ë¦¬ í™”ë©´ ì—…ë°ì´íŠ¸
        function updateInventoryDisplay() {
            const gemList = document.getElementById('gemList');
            gemList.innerHTML = '';

            Object.keys(inventory).forEach(gemId => {
                const gem = gemData[gemId];
                const count = inventory[gemId];
                const isEquipped = equippedGem == gemId;
                const gemElement = document.createElement('div');
                gemElement.className = `bg-white bg-opacity-10 hover:bg-opacity-20 rounded-lg p-3 cursor-pointer transition-all duration-300 text-center relative ${isEquipped ? 'ring-2 ring-yellow-400' : ''}`;
                gemElement.innerHTML = `
                    <div class="text-2xl mb-1">${gem.emoji}</div>
                    <div class="text-xs text-white">${gem.name}</div>
                    <div class="absolute top-1 right-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">${count}</div>
                    ${isEquipped ? '<div class="text-xs text-yellow-400 mt-1">ì¥ì°©ë¨</div>' : ''}
                `;
                gemElement.addEventListener('click', () => showGemDetails(gemId));
                gemList.appendChild(gemElement);
            });

            if (Object.keys(inventory).length === 0) {
                gemList.innerHTML = '<div class="col-span-full text-center text-gray-400 py-8">ë³´ì„ì´ ì—†ìŠµë‹ˆë‹¤</div>';
            }
        }

        // ë³´ì„ ìƒì„¸ ì •ë³´ í‘œì‹œ
        function showGemDetails(gemId) {
            const gem = gemData[gemId];
            const gemDetails = document.getElementById('gemDetails');
            const count = inventory[gemId] || 0;
            
            // ìŠ¤íƒ¯ í…ìŠ¤íŠ¸ ìƒì„±
            let statsText = `ì½”ëŸ¬ìŠ¤ +${gem.chorus}`;
            if (gem.multiple > 1) {
                statsText += ` | x${gem.multiple}`;
            }
            
            const isEquipped = equippedGem == gemId;
            const canExtract = count >= 2;
            
            gemDetails.innerHTML = `
                <div class="text-6xl mb-4">${gem.emoji}</div>
                <h3 class="text-xl font-bold mb-2">${gem.name}</h3>
                <div class="text-blue-300 font-medium mb-2">${statsText}</div>
                <div class="text-gray-400 text-sm mb-4">ë³´ìœ  ê°œìˆ˜: ${count}ê°œ</div>
                <p class="text-gray-300 mb-4">${gem.description}</p>
                <div class="flex gap-2 justify-center">
                    ${isEquipped ? 
                        '<button onclick="unequipGem()" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">ì¥ì°© í•´ì œ</button>' :
                        `<button onclick="equipGem(${gemId})" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">ì¥ì°©í•˜ê¸°</button>`
                    }
                    ${canExtract ? 
                        `<button onclick="extractGem(${gemId})" class="bg-purple-500 hover:bg-purple-600 px-4 py-2 rounded-full text-white font-bold transition-all duration-300">ì¶”ì¶œ</button>` :
                        '<button class="bg-gray-500 px-4 py-2 rounded-full text-white font-bold opacity-50 cursor-not-allowed" disabled>ì¶”ì¶œ ë¶ˆê°€</button>'
                    }
                </div>
            `;
        }

        // ë½‘ê¸° ì‹œì‘ í•¨ìˆ˜ (ìƒì ì—ì„œ í˜¸ì¶œ)
        function startGacha(type) {
            if (isGachaActive) return; // ë½‘ê¸° ì§„í–‰ ì¤‘ì´ë©´ ë¬´ì‹œ
            
            let cost, currency, hasEnough;
            
            switch(type) {
                case 'beginner':
                    cost = 10;
                    currency = 'points';
                    hasEnough = points >= cost;
                    break;
                case 'normal':
                    cost = 5;
                    currency = 'prisms';
                    hasEnough = prisms >= cost;
                    break;
                case 'premium':
                    cost = 30;
                    currency = 'prisms';
                    hasEnough = prisms >= cost;
                    break;
                case 'luxury':
                    cost = 40;
                    currency = 'prisms';
                    hasEnough = prisms >= cost;
                    break;
            }
            
            if (hasEnough) {
                if (currency === 'points') {
                    points -= cost;
                } else {
                    prisms -= cost;
                }
                updateDisplay();
                autoSave(); // ìë™ ì €ì¥
                
                // ìƒì  ë‹«ê¸°
                const shopScreen = document.getElementById('shopScreen');
                shopScreen.style.opacity = '0';
                shopScreen.style.pointerEvents = 'none';
                
                // ë½‘ê¸° íƒ€ì… ì €ì¥í•˜ê³  ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
                window.currentGachaType = type;
                startGachaAnimation();
            } else {
                const currencyName = currency === 'points' ? 'í¬ì¸íŠ¸' : 'í”„ë¦¬ì¦˜';
                showMessage(`${currencyName}ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (${cost} ${currencyName} í•„ìš”)`, 'text-red-300');
            }
        }

        // ë½‘ê¸° ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        function startGachaAnimation() {
            isGachaActive = true; // ë½‘ê¸° ì§„í–‰ ìƒíƒœë¡œ ë³€ê²½
            
            const mainUI = document.getElementById('mainUI');
            const gachaScreen = document.getElementById('gachaScreen');
            const gemstone = document.getElementById('gemstone');
            
            // ë©”ì¸ UI ìˆ¨ê¸°ê³  ë½‘ê¸° í™”ë©´ í‘œì‹œ
            mainUI.style.opacity = '0';
            gachaScreen.style.opacity = '1';
            gachaScreen.style.pointerEvents = 'auto';
            
            // ì›ì„ í´ë¦­ ì´ë²¤íŠ¸ (ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€)
            gemstone.onclick = null;
            gemstone.onclick = () => {
                revealGrade();
            };
        }

        // ë“±ê¸‰ë³„ ë³´ì„ ë³´ìƒ ì„¤ì • (ìœ ì§€ë³´ìˆ˜ ì‰½ê²Œ í•˜ê¸° ìœ„í•´ ë³„ë„ ê°ì²´ë¡œ ê´€ë¦¬)
        const gemRewards = {
            'ì¼ë°˜': [1, 2, 3],
            'í¬ê·€': [4, 5, 6], 
            'ì—í”½': [7, 8, 9],
            'ì „ì„¤': [10, 11, 12],
            'ìœ ë‹ˆí¬': [13, 14, 15]
        };

        // ë“±ê¸‰ ê²°ì • ë° ê³µê°œ
        function revealGrade() {
            // ë½‘ê¸° íƒ€ì…ë³„ í™•ë¥  ì„¤ì •
            let grades;
            switch(window.currentGachaType) {
                case 'beginner':
                    grades = [
                        { name: 'ì¼ë°˜', class: 'grade-common', probability: 0.7 },
                        { name: 'í¬ê·€', class: 'grade-rare', probability: 0.2 },
                        { name: 'ì—í”½', class: 'grade-epic', probability: 0.08 },
                        { name: 'ì „ì„¤', class: 'grade-legendary', probability: 0.015 },
                        { name: 'ìœ ë‹ˆí¬', class: 'grade-unique', probability: 0.005 }
                    ];
                    break;
                case 'normal':
                    grades = [
                        { name: 'ì¼ë°˜', class: 'grade-common', probability: 0.5 },
                        { name: 'í¬ê·€', class: 'grade-rare', probability: 0.25 },
                        { name: 'ì—í”½', class: 'grade-epic', probability: 0.15 },
                        { name: 'ì „ì„¤', class: 'grade-legendary', probability: 0.07 },
                        { name: 'ìœ ë‹ˆí¬', class: 'grade-unique', probability: 0.03 }
                    ];
                    break;
                case 'premium':
                    grades = [
                        { name: 'ì¼ë°˜', class: 'grade-common', probability: 0.3 },
                        { name: 'í¬ê·€', class: 'grade-rare', probability: 0.3 },
                        { name: 'ì—í”½', class: 'grade-epic', probability: 0.25 },
                        { name: 'ì „ì„¤', class: 'grade-legendary', probability: 0.1 },
                        { name: 'ìœ ë‹ˆí¬', class: 'grade-unique', probability: 0.05 }
                    ];
                    break;
                case 'luxury':
                    grades = [
                        { name: 'ì¼ë°˜', class: 'grade-common', probability: 0.3 },
                        { name: 'í¬ê·€', class: 'grade-rare', probability: 0.3 },
                        { name: 'ì—í”½', class: 'grade-epic', probability: 0.25 },
                        { name: 'ì „ì„¤', class: 'grade-legendary', probability: 0.1 },
                        { name: 'ìœ ë‹ˆí¬', class: 'grade-unique', probability: 0.05 }
                    ];
                    break;
                default:
                    grades = [
                        { name: 'ì¼ë°˜', class: 'grade-common', probability: 0.5 },
                        { name: 'í¬ê·€', class: 'grade-rare', probability: 0.25 },
                        { name: 'ì—í”½', class: 'grade-epic', probability: 0.15 },
                        { name: 'ì „ì„¤', class: 'grade-legendary', probability: 0.07 },
                        { name: 'ìœ ë‹ˆí¬', class: 'grade-unique', probability: 0.03 }
                    ];
            }

            // í™•ë¥ ì— ë”°ë¥¸ ë“±ê¸‰ ê²°ì •
            const random = Math.random();
            let currentProbability = 0;
            let selectedGrade = grades[0];

            for (const grade of grades) {
                currentProbability += grade.probability;
                if (random <= currentProbability) {
                    selectedGrade = grade;
                    break;
                }
            }

            // ë“±ê¸‰ ê³µê°œ í™”ë©´ í‘œì‹œ
            const gachaScreen = document.getElementById('gachaScreen');
            const revealScreen = document.getElementById('revealScreen');
            const gradeText = document.getElementById('gradeText');

            // ë½‘ê¸° í™”ë©´ ìˆ¨ê¸°ê¸°
            gachaScreen.style.opacity = '0';
            gachaScreen.style.pointerEvents = 'none';

            // ë“±ê¸‰ ê³µê°œ í™”ë©´ í‘œì‹œ
            setTimeout(() => {
                revealScreen.style.opacity = '1';
                revealScreen.style.pointerEvents = 'auto';
                revealScreen.className = `fixed inset-0 flex items-center justify-center z-50 transition-all duration-1000 ${selectedGrade.class}`;
                gradeText.textContent = selectedGrade.name;
                
                // ì„ íƒëœ ë“±ê¸‰ì„ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥ (ë³´ì„ íšë“ í™”ë©´ì—ì„œ ì‚¬ìš©)
                window.currentGrade = selectedGrade.name;
            }, 500);
        }

        // ê³„ì†í•˜ê¸° ë²„íŠ¼ (ë“±ê¸‰ ê³µê°œ -> ë³´ì„ íšë“ í™”ë©´ìœ¼ë¡œ)
        document.getElementById('continueBtn').addEventListener('click', () => {
            showGemReward();
        });

        // ë³´ì„ íšë“ í™”ë©´ í‘œì‹œ
        function showGemReward() {
            const revealScreen = document.getElementById('revealScreen');
            const gemRewardScreen = document.getElementById('gemRewardScreen');
            const rewardText = document.getElementById('rewardText');
            const rewardGemImage = document.getElementById('rewardGemImage');
            
            // í˜„ì¬ ë“±ê¸‰ì— ë”°ë¥¸ ë³´ì„ ì„ íƒ
            let possibleRewards = gemRewards[window.currentGrade];
            let selectedReward;
            
            // ê´‘ì•ˆì˜ ì›ì„ íŠ¹ë³„ í™•ë¥  ì ìš©
            if (window.currentGachaType === 'luxury') {
                if (window.currentGrade === 'ì „ì„¤') {
                    // í† íŒŒì¦ˆ(12ë²ˆ) ë†’ì€ í™•ë¥ 
                    const random = Math.random();
                    if (random < 0.6) {
                        selectedReward = 12; // í† íŒŒì¦ˆ
                    } else {
                        selectedReward = possibleRewards[Math.floor(Math.random() * possibleRewards.length)];
                    }
                } else if (window.currentGrade === 'ìœ ë‹ˆí¬') {
                    // íƒœì–‘ì˜ ì‹¬ì¥(15ë²ˆ) ë†’ì€ í™•ë¥ 
                    const random = Math.random();
                    if (random < 0.6) {
                        selectedReward = 15; // íƒœì–‘ì˜ ì‹¬ì¥
                    } else {
                        selectedReward = possibleRewards[Math.floor(Math.random() * possibleRewards.length)];
                    }
                } else {
                    selectedReward = possibleRewards[Math.floor(Math.random() * possibleRewards.length)];
                }
            } else {
                selectedReward = possibleRewards[Math.floor(Math.random() * possibleRewards.length)];
            }
            
            // ì¸ë²¤í† ë¦¬ì— ë³´ì„ ì¶”ê°€
            if (inventory[selectedReward]) {
                inventory[selectedReward]++;
            } else {
                inventory[selectedReward] = 1;
            }
            autoSave(); // ìë™ ì €ì¥
            
            // ë³´ì„ ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            const gem = gemData[selectedReward];
            rewardGemImage.innerHTML = gem.emoji;
            rewardGemImage.className = 'w-24 h-24 sm:w-32 sm:h-32 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mx-auto mb-6 shadow-2xl flex items-center justify-center text-3xl sm:text-4xl';
            
            // ë“±ê¸‰ ê³µê°œ í™”ë©´ ìˆ¨ê¸°ê¸°
            revealScreen.style.opacity = '0';
            revealScreen.style.pointerEvents = 'none';
            
            // ë³´ì„ íšë“ í™”ë©´ í‘œì‹œ
            setTimeout(() => {
                rewardText.textContent = `${gem.name} íšë“!`;
                gemRewardScreen.style.opacity = '1';
                gemRewardScreen.style.pointerEvents = 'auto';
            }, 500);
        }

        // ìµœì¢… í™•ì¸ ë²„íŠ¼ (ë³´ì„ íšë“ í™”ë©´ -> ë©”ì¸ UIë¡œ)
        document.getElementById('finalContinueBtn').addEventListener('click', () => {
            const mainUI = document.getElementById('mainUI');
            const revealScreen = document.getElementById('revealScreen');
            const gemRewardScreen = document.getElementById('gemRewardScreen');
            
            // ë³´ì„ íšë“ í™”ë©´ ìˆ¨ê¸°ê¸°
            gemRewardScreen.style.opacity = '0';
            gemRewardScreen.style.pointerEvents = 'none';
            
            // ë©”ì¸ UI ë‹¤ì‹œ í‘œì‹œ
            setTimeout(() => {
                mainUI.style.opacity = '1';
                isGachaActive = false; // ë½‘ê¸° ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½
            }, 300);
            
            // ëª¨ë“  í™”ë©´ ì™„ì „íˆ ì´ˆê¸°í™”
            setTimeout(() => {
                revealScreen.className = 'fixed inset-0 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-all duration-1000';
                revealScreen.style.background = '';
                revealScreen.style.animation = '';
                gemRewardScreen.style.opacity = '0';
                gemRewardScreen.style.pointerEvents = 'none';
            }, 1000);
        });

        // ë³´ì„ ì¥ì°© í•¨ìˆ˜
        function equipGem(gemId) {
            equippedGem = gemId;
            const gem = gemData[gemId];
            chorus = gem.chorus;
            multiple = gem.multiple;
            updateEquippedGemDisplay();
            updateInventoryDisplay(); // ì¸ë²¤í† ë¦¬ í™”ë©´ ìƒˆë¡œê³ ì¹¨
            showGemDetails(gemId); // ìƒì„¸ ì •ë³´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            autoSave(); // ìë™ ì €ì¥
            showMessage(`${gem.name}ì„(ë¥¼) ì¥ì°©í–ˆìŠµë‹ˆë‹¤!`, 'text-green-300');
        }

        // ë³´ì„ ì¥ì°© í•´ì œ í•¨ìˆ˜
        function unequipGem() {
            const prevGemId = equippedGem;
            equippedGem = null;
            chorus = 1;
            multiple = 1;
            updateEquippedGemDisplay();
            updateInventoryDisplay(); // ì¸ë²¤í† ë¦¬ í™”ë©´ ìƒˆë¡œê³ ì¹¨
            if (prevGemId) showGemDetails(prevGemId); // ìƒì„¸ ì •ë³´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            autoSave(); // ìë™ ì €ì¥
            showMessage('ë³´ì„ ì¥ì°©ì„ í•´ì œí–ˆìŠµë‹ˆë‹¤!', 'text-yellow-300');
        }

        // ë³´ì„ ì¶”ì¶œ í•¨ìˆ˜
        function extractGem(gemId) {
            const gem = gemData[gemId];
            const count = inventory[gemId];
            
            if (count >= 2) {
                inventory[gemId]--;
                
                // ë³´ì„ ë“±ê¸‰ë³„ í”„ë¦¬ì¦˜ íšë“ëŸ‰ ì„¤ì •
                let prismReward;
                if (gemId <= 3) { // ì¼ë°˜ ë“±ê¸‰
                    prismReward = 1;
                } else if (gemId <= 6) { // í¬ê·€ ë“±ê¸‰
                    prismReward = 3;
                } else if (gemId <= 9) { // ì—í”½ ë“±ê¸‰
                    prismReward = 8;
                } else if (gemId <= 12) { // ì „ì„¤ ë“±ê¸‰
                    prismReward = 20;
                } else { // ìœ ë‹ˆí¬ ë“±ê¸‰
                    prismReward = 60;
                }
                
                prisms += prismReward;
                updateDisplay();
                updateInventoryDisplay();
                showGemDetails(gemId); // ìƒì„¸ ì •ë³´ ìƒˆë¡œê³ ì¹¨
                autoSave(); // ìë™ ì €ì¥
                showMessage(`${gem.name}ì„(ë¥¼) ì¶”ì¶œí•˜ì—¬ í”„ë¦¬ì¦˜ ${prismReward}ê°œë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤!`, 'text-purple-300');
            }
        }

        // ì¥ì°©ëœ ë³´ì„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateEquippedGemDisplay() {
            const equippedGemDisplay = document.getElementById('equippedGemDisplay');
            const equippedGemIcon = document.getElementById('equippedGemIcon');
            const equippedGemName = document.getElementById('equippedGemName');
            const equippedGemStats = document.getElementById('equippedGemStats');

            if (equippedGem) {
                const gem = gemData[equippedGem];
                equippedGemIcon.textContent = gem.emoji;
                equippedGemName.textContent = gem.name;
                
                let statsText = `ì½”ëŸ¬ìŠ¤ +${gem.chorus}`;
                if (gem.multiple > 1) {
                    statsText += ` | x${gem.multiple}`;
                }
                equippedGemStats.textContent = statsText;
                
                equippedGemDisplay.style.opacity = '1';
            } else {
                equippedGemDisplay.style.opacity = '0';
            }
        }

        // ë¡œì»¬ ì €ì¥ì†Œ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function saveGameData() {
            const gameData = {
                points: points,
                prisms: prisms,
                inventory: inventory,
                equippedGem: equippedGem,
                chorus: chorus,
                multiple: multiple,
                lastSaved: Date.now()
            };
            localStorage.setItem('gemGachaGame', JSON.stringify(gameData));
        }

        function loadGameData() {
            try {
                const savedData = localStorage.getItem('gemGachaGame');
                if (savedData) {
                    const gameData = JSON.parse(savedData);
                    points = gameData.points || 0;
                    prisms = gameData.prisms || 0;
                    inventory = gameData.inventory || {};
                    equippedGem = gameData.equippedGem || null;
                    chorus = gameData.chorus || 1;
                    multiple = gameData.multiple || 1;
                    
                    showMessage('ì €ì¥ëœ ê²Œì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!', 'text-green-300');
                    return true;
                }
            } catch (error) {
                console.error('ê²Œì„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showMessage('ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'text-red-300');
            }
            return false;
        }

        function resetGameData() {
            if (confirm('ì •ë§ë¡œ ê²Œì„ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                localStorage.removeItem('gemGachaGame');
                points = 0;
                prisms = 0;
                inventory = {};
                equippedGem = null;
                chorus = 1;
                multiple = 1;
                updateDisplay();
                updateEquippedGemDisplay();
                showMessage('ê²Œì„ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'text-yellow-300');
            }
        }

        // ê²Œì„ ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ìë™ ì €ì¥
        function autoSave() {
            saveGameData();
        }

        // ì´ˆê¸° í™”ë©´ ì—…ë°ì´íŠ¸ ë° ë°ì´í„° ë¡œë“œ
        loadGameData();
        updateDisplay();
        updateEquippedGemDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97750a7200f3c441',t:'MTc1NjU2NDgwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
